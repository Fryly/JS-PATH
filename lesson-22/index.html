<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>defer & async</title>
</head>

<body>

    <!-- В современных сайтах скрипты обычно «тяжелее», чем HTML: они весят больше, дольше обрабатываются. -->

    <!-- <p>...содержимое перед скриптом без deffer...</p> -->

    <!-- <script src="script.js"></script> -->

    <!-- Это не отобразится, пока скрипт не загрузится -->
    <!-- <p>...содержимое после скрипта без deffer...</p> -->

    <!-- DEFER -->

    <!-- Атрибут defer сообщает браузеру, что он должен продолжать обрабатывать страницу и загружать скрипт в фоновом режиме, а затем запустить этот скрипт, когда он загрузится. -->

    <!-- <p>...содержимое перед скриптом с defer...</p> -->

    <!-- <script defer src="script.js"></script> -->

    <!-- отображается сразу же -->
    <!-- <p>...содержимое после скрипта с defer...</p> -->

    <!-- Скрипты с defer никогда не блокируют страницу. -->
    <!-- Скрипты с defer всегда выполняются, когда дерево DOM готово, но до события DOMContentLoaded. -->

    <!-- <p>...содержимое до скрипта...</p> -->

    <!-- <script>
        document.addEventListener('DOMContentLoaded', () => console.log("Дерево DOM готово после скрипта с 'defer'!"));
    </script> -->

    <!-- <script defer src="script.js"></script> -->

    <!-- <p>...содержимое после скрипта...</p> -->

    <!-- Отложенные с помощью defer скрипты сохраняют порядок относительно друг друга, как и обычные скрипты. -->

    <!-- Маленький скрипт загрузится первым, но выполнится вторым -->

    <!-- Атрибут defer предназначен только для внешних скриптов -->

    <!-- Атрибут defer будет проигнорирован, если в теге <script> нет src. -->

    <!-- ASYNC -->

    <!-- Атрибут async означает, что скрипт абсолютно независим: -->

    <!-- Событие DOMContentLoaded и асинхронные скрипты не ждут друг друга: -->

    <p>...содержимое до скрипта...</p>

    <script>
        document.addEventListener('DOMContentLoaded', () => console.log("DOM готов!"));
    </script>

    <script async src="script.js"></script>

    <p>...содержимое после скрипта...</p>

    <!-- Содержимое страницы отображается сразу же : async его не блокирует. -->

    <!-- DOMContentLoaded может произойти как до, так и после async, никаких гарантий нет. -->

    <!-- Асинхронные скрипты не ждут друг друга. Меньший скрипт small.js идёт вторым, но скорее всего загрузится раньше long.js, поэтому и запустится первым. То есть, скрипты выполняются в порядке загрузки. -->

    <!-- Асинхронные скрипты очень полезны для добавления на страницу сторонних скриптов: счётчиков, рекламы и т.д. Они не зависят от наших скриптов, и мы тоже не должны ждать их: -->
</body>

</html>